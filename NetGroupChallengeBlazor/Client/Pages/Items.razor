@page "/items"

@using Microsoft.AspNetCore.Authorization
@using DTOModels
@using NetGroupChallengeBlazor.Client.Components
@using BlazorClientServices.Interfaces

@attribute [Authorize(Roles = "User, Admin")]
@inject IApiService apiService

<ItemsSearchComponent>

</ItemsSearchComponent>

<ItemsListComponent Items="@ItemsList" OnUpdateCallback="@UpdateItemsAsync">

</ItemsListComponent>

@code {
    private List<ItemDTO> ItemsList = new List<ItemDTO>();

    protected override async Task OnInitializedAsync() {
        await UpdateItemsAsync();
    }

    private async Task UpdateItemsAsync() {
        ItemsList = await apiService.GetItemsAsync($"api/items");
    }
}
